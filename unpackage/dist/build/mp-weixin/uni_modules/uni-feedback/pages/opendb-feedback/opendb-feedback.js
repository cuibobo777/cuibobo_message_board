"use strict";const e=require("../../../../common/vendor.js"),o=require("../../js_sdk/validator/opendb-feedback.js");console.log(o.validator);const t=e.Es.database();function n(e){let t={};for(let n in o.validator)e.indexOf(n)>-1&&(t[n]=o.validator[n]);return t}const a={data(){let e={content:"",imgs:[],contact:"",mobile:""};return{formData:e,formOptions:{},rules:{...n(Object.keys(e))}}},onReady(){this.$refs.form.setRules(this.rules)},methods:{submit(){e.index.showLoading({mask:!0}),this.$refs.form.validate().then((e=>{this.submitForm(e)})).catch((()=>{e.index.hideLoading()}))},fabClick(){e.index.navigateTo({url:"/uni_modules/uni-feedback/pages/opendb-feedback/list"})},submitForm(o){t.collection("opendb-feedback").add(o).then((o=>{e.index.showToast({icon:"none",title:"提交成功"}),this.getOpenerEventChannel().emit("refreshData"),setTimeout((()=>e.index.navigateBack()),500)})).catch((o=>{e.index.showModal({content:o.message||"请求服务失败",showCancel:!1})})).finally((()=>{e.index.hideLoading()}))}}};if(!Array){(e.resolveComponent("uni-forms-item")+e.resolveComponent("uni-file-picker")+e.resolveComponent("uni-easyinput")+e.resolveComponent("uni-forms")+e.resolveComponent("uni-fab"))()}Math||((()=>"../../../uni-forms/components/uni-forms-item/uni-forms-item.js")+(()=>"../../../uni-file-picker/components/uni-file-picker/uni-file-picker.js")+(()=>"../../../uni-easyinput/components/uni-easyinput/uni-easyinput.js")+(()=>"../../../uni-forms/components/uni-forms/uni-forms.js")+(()=>"../../../uni-fab/components/uni-fab/uni-fab.js"))();const i=e._export_sfc(a,[["render",function(o,t,n,a,i,s){return e.e({a:e.o([e=>i.formData.content=e.detail.value,e=>o.binddata("content",e.detail.value)]),b:i.formData.content,c:e.p({name:"content",label:"留言内容/回复内容",required:!0}),d:e.o((e=>i.formData.imgs=e)),e:e.p({"file-mediatype":"image",limit:6,"return-type":"array",modelValue:i.formData.imgs}),f:e.p({name:"imgs",label:"图片列表"}),g:e.o((e=>i.formData.contact=e)),h:e.p({trim:"both",modelValue:i.formData.contact}),i:e.p({name:"contact",label:"联系人"}),j:e.o((e=>i.formData.mobile=e)),k:e.p({trim:"both",modelValue:i.formData.mobile}),l:e.p({name:"mobile",label:"联系电话"}),m:e.o(((...e)=>s.submit&&s.submit(...e))),n:e.sr("form","6fae4dce-0"),o:e.p({value:i.formData,"validate-trigger":"submit","err-show-type":"toast"}),p:o.uniIDHasRole("webmaster")||o.uniIDHasRole("admin")},o.uniIDHasRole("webmaster")||o.uniIDHasRole("admin")?{q:e.sr("fab","6fae4dce-8"),r:e.o(s.fabClick),s:e.p({horizontal:"right",vertical:"bottom","pop-menu":!1})}:{})}]]);wx.createPage(i);
