"use strict";const t=require("../../../../../common/vendor.js"),a=require("./config.js");var s={abbr:1,b:1,big:1,code:1,del:1,em:1,i:1,ins:1,label:1,q:1,small:1,span:1,strong:1,sub:1,sup:1};let e={Parser:{}};const r=a.cfg.errorImg,i={components:{trees:()=>Promise.resolve().then((()=>l))},name:"trees",data:()=>({ctrl:[],placeholder:'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="300" height="225"/>',errorImg:r,loadVideo:"undefined"==typeof plus,c:"",s:""}),props:{nodes:Array,lazyLoad:Boolean,loading:String},mounted(){for(this.top=this.$parent;"parser"!=this.top.$options.name;this.top=this.top.$parent);this.init()},methods:{init(){for(var a,s=this.nodes.length;a=this.nodes[--s];)if("img"==a.name)this.top.imgList.setItem(a.attrs.i,a.attrs["original-src"]||a.attrs.src);else if("video"==a.name||"audio"==a.name){var e;"video"==a.name?e=t.index.createVideoContext(a.attrs.id,this):this.$refs[a.attrs.id]&&(e=this.$refs[a.attrs.id][0]),e&&(e.id=a.attrs.id,this.top.videoContexts.push(e))}},play(t){var a=this.top.videoContexts;if(a.length>1&&this.top.autopause)for(var s=a.length;s--;)a[s].id!=t.currentTarget.dataset.id&&a[s].pause()},imgtap(a){var s=a.currentTarget.dataset.attrs;if(!s.ignore){var r=!0,i={id:a.target.id,src:s.src,ignore:()=>r=!1};if(e.Parser.onImgtap&&e.Parser.onImgtap(i),this.top.$emit("imgtap",i),r){var o=this.top.imgList,l=o[s.i]?parseInt(s.i):(o=[s.src],0);t.index.previewImage({current:l,urls:o})}}},loadImg(t){var a=t.currentTarget.dataset.i;this.lazyLoad&&!this.ctrl[a]?this.$set(this.ctrl,a,1):this.loading&&2!=this.ctrl[a]&&this.$set(this.ctrl,a,2)},linkpress(a){var s=!0,r=a.currentTarget.dataset.attrs;if(r.ignore=()=>s=!1,e.Parser.onLinkpress&&e.Parser.onLinkpress(r),this.top.$emit("linkpress",r),s){if(r["app-id"])return t.index.navigateToMiniProgram({appId:r["app-id"],path:r.path});r.href&&("#"==r.href[0]?this.top.useAnchor&&this.top.navigateTo({id:r.href.substring(1)}):0==r.href.indexOf("http")||0==r.href.indexOf("//")?t.index.setClipboardData({data:r.href,success:()=>t.index.showToast({title:"链接已复制"})}):t.index.navigateTo({url:r.href,fail(){t.index.switchTab({url:r.href})}}))}},error(t){var a=t.currentTarget,s=a.dataset.source,e=a.dataset.i;if("video"==s||"audio"==s){var r=this.ctrl[e]?this.ctrl[e].i+1:1;r<this.nodes[e].attrs.source.length&&this.$set(this.ctrl,e,r),t.detail.__args__&&(t.detail=t.detail.__args__[0])}this.top&&this.top.$emit("error",{source:s,target:a,errMsg:t.detail.errMsg})},_loadVideo(t){this.$set(this.ctrl,t.target.dataset.i,0)},use:t=>!t.c&&!s[t.name]&&-1==(t.attrs.style||"").indexOf("display:inline")}};if(!Array){t.resolveComponent("trees")()}const o=t._export_sfc(i,[["render",function(a,s,e,r,i,o){return{a:t.f(e.nodes,((a,s,r)=>t.e({a:"img"==a.name},"img"==a.name?t.e({b:0!=i.ctrl[s]},0!=i.ctrl[s]?{c:[{attrs:{src:e.loading&&(i.ctrl[s]||0)<2?e.loading:e.lazyLoad&&!i.ctrl[s]?i.placeholder:3==i.ctrl[s]?i.errorImg:a.attrs.src||"",alt:a.attrs.alt||"",width:a.attrs.width||"",style:"-webkit-touch-callout:none;max-width:100%;display:block"+(a.attrs.height?";height:"+a.attrs.height:"")},name:"img"}]}:{},{d:e.lazyLoad&&!i.ctrl[s]?i.placeholder:a.attrs.src,e:e.lazyLoad,f:!a.attrs.ignore,g:s,h:a.attrs.i,i:t.o(((...t)=>o.loadImg&&o.loadImg(...t)),s),j:t.o(((...t)=>o.error&&o.error(...t)),s),k:t.n("_img "+a.attrs.class),l:t.s(a.attrs.style),m:a.attrs,n:t.o(((...t)=>o.imgtap&&o.imgtap(...t)),s)}):"text"==a.type?{p:t.t(a.text)}:"br"==a.name?{}:(a.lazyLoad&&!a.attrs.autoplay||"video"==a.name&&!i.loadVideo)&&null==i.ctrl[s]?{s:a.attrs.id,t:t.n("_video "+(a.attrs.class||"")),v:t.s(a.attrs.style),w:s,x:t.o(((...t)=>o._loadVideo&&o._loadVideo(...t)),s)}:"video"==a.name?{z:a.attrs.id,A:t.n(a.attrs.class),B:t.s(a.attrs.style),C:a.attrs.autoplay||0==i.ctrl[s],D:a.attrs.controls,E:a.attrs.loop,F:a.attrs.muted,G:a.attrs.poster,H:a.attrs.source[i.ctrl[s]||0],I:a.attrs["unit-id"],J:a.attrs.id,K:s,L:t.o(((...t)=>o.error&&o.error(...t)),s),M:t.o(((...t)=>o.play&&o.play(...t)),s)}:"audio"==a.name?{O:a.attrs.id,P:t.n(a.attrs.class),Q:t.s(a.attrs.style),R:a.attrs.author,S:a.attrs.autoplay,T:a.attrs.controls,U:a.attrs.loop,V:a.attrs.name,W:a.attrs.poster,X:a.attrs.source[i.ctrl[s]||0],Y:s,Z:a.attrs.id,aa:t.o(((...t)=>o.error&&o.error(...t)),s),ab:t.o(((...t)=>o.play&&o.play(...t)),s)}:"a"==a.name?{ad:"bd1d4456-0-"+r,ae:t.p({c:"_span",nodes:a.children}),af:a.attrs.id,ag:t.n("_a "+(a.attrs.class||"")),ah:t.s(a.attrs.style),ai:a.attrs,aj:t.o(((...t)=>o.linkpress&&o.linkpress(...t)),s)}:"li"==a.name?t.e({al:"ol"==a.type},"ol"==a.type?{am:t.t(a.num)}:t.e({an:a.floor%3==0},(a.floor%3==0||a.floor,{}),{ao:a.floor%3==2}),{ap:"bd1d4456-1-"+r,aq:t.p({c:"_li",nodes:a.children,lazyLoad:e.lazyLoad,loading:e.loading}),ar:a.attrs.id,as:t.n(a.attrs.class),at:t.s((a.attrs.style||"")+";display:flex;flex-direction:row")}):"table"==a.name&&a.c&&a.flag?{aw:t.f(a.children,((a,s,e)=>({a:s,b:t.n(a.attrs.class),c:t.s(a.attrs.style),d:"bd1d4456-2-"+r+"-"+e,e:t.p({c:a.attrs.class,s:a.attrs.style,nodes:a.children})}))),ax:a.attrs.id,ay:t.n(a.attrs.class),az:t.s((a.attrs.style||"")+";display:grid")}:"table"==a.name&&a.c?{aB:t.f(a.children,((a,s,e)=>({a:t.f(a.children,((a,s,i)=>t.e({a:"td"==a.name},"td"==a.name?{b:"bd1d4456-3-"+r+"-"+e+"-"+i,c:t.p({nodes:a.children})}:{d:t.f(a.children,((a,s,o)=>({a:s,b:t.n(a.attrs.class),c:t.s((a.attrs.style||"")+("t"==a.name[0]?";display:table-"+("tr"==a.name?"row":"cell"):"")),d:"bd1d4456-4-"+r+"-"+e+"-"+i+"-"+o,e:t.p({c:a.attrs.class,s:(a.attrs.style||"")+("t"==a.name[0]?";display:table-"+("tr"==a.name?"row":"cell"):""),nodes:a.children})})))},{e:s,f:t.n(a.attrs.class),g:t.s((a.attrs.style||"")+("t"==a.name[0]?";display:table-"+("tr"==a.name?"row":"cell"):""))}))),b:s,c:t.n(a.attrs.class),d:t.s((a.attrs.style||"")+("t"==a.name[0]?";display:table-"+("tr"==a.name?"row":"row-group"):""))}))),aC:a.attrs.id,aD:t.n(a.attrs.class),aE:t.s((a.attrs.style||"")+";display:table")}:o.use(a)?{aG:a.attrs.id,aH:t.n("_p __"+a.name),aI:[a]}:{aJ:t.n((a.attrs.id||"")+" _"+a.name+" "+(a.attrs.class||"")),aK:t.s(a.attrs.style),aL:"bd1d4456-5-"+r,aM:t.p({c:(a.attrs.id||"")+" _"+a.name+" "+(a.attrs.class||""),s:a.attrs.style,nodes:a.children,lazyLoad:e.lazyLoad,loading:e.loading})},{o:"text"==a.type,q:"br"==a.name,r:(a.lazyLoad&&!a.attrs.autoplay||"video"==a.name&&!i.loadVideo)&&null==i.ctrl[s],y:"video"==a.name,N:"audio"==a.name,ac:"a"==a.name,ak:"li"==a.name,av:"table"==a.name&&a.c&&a.flag,aA:"table"==a.name&&a.c,aF:o.use(a),aN:s}))),b:t.n("interlayer "+(i.c||"")),c:t.s(i.s)}}]]);wx.createComponent(o);const l=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));
